<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alone Empty Together</title>
    <style>
        body { font-family: 'Arial', sans-serif; background: #f8f9fa; margin: 0; color: #333; padding-bottom: 160px; }
        .container { max-width: 800px; margin: 40px auto; background: white; padding: 40px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); }
        .logo { max-width: 280px; display: block; margin: 0 auto 20px; }
        .section { display: none; }
        .active { display: block; }
        .btn { padding: 15px 30px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: bold; transition: 0.3s; text-align: center; display: inline-block; width: 100%; box-sizing: border-box; }
        .btn-start { background: #000; color: white; margin-top: 20px; }
        .btn-opt { background: #f1f3f5; text-align: left; margin: 8px 0; border: 1px solid #ddd; padding: 15px; width: 100%; color: #333; }
        .btn-opt:hover { background: #e2e6ea; }

        /* Stiluri pentru Rezultat și Blur */
        .manifesto-text { text-align: left; line-height: 1.8; font-size: 16px; margin-top: 20px; border-top: 2px solid #eee; padding-top: 20px; }
        .result-block { display: none; padding: 20px; background: #fff; }
        .blurred { filter: blur(8px); user-select: none; pointer-events: none; }
        
        .result-display-box { background: #e7f5ff; border: 2px solid #228be6; padding: 30px; border-radius: 10px; margin-top: 20px; position: relative; }
        .locked-overlay { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.4); font-weight: bold; text-transform: uppercase; z-index: 10; }

        .float-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: white; box-shadow: 0 -5px 25px rgba(0,0,0,0.15); padding: 20px 0; z-index: 9999; text-align: center; display: none; }
        .btn-wish { background: #28a745; color: white; margin: 5px auto; width: 90%; max-width: 300px; display: block; }
        .btn-no { background: #dc3545; color: white; margin: 5px auto; width: 90%; max-width: 300px; display: block; }
    </style>
</head>
<body>

<div class="container">
    <div id="intro" class="section active">
        <img src="logo.png" alt="Logo" class="logo">
        <p style="text-align:center;">Discover your personal love and attraction style. Answer 20 professional questions to unlock your blueprint.</p>
        <button class="btn btn-start" onclick="startQuiz()">Continue to Test</button>
    </div>

    <div id="quiz" class="section">
        <h2 id="q-title" style="text-align:center;"></h2>
        <div id="q-options"></div>
    </div>

    <div id="result-preview" class="section">
        <h2 style="text-align:center;">Your Personal Analysis</h2>
        <div id="preview-container" class="result-display-box">
            <div id="lock-text" class="locked-overlay">Content Locked - Complete Payment to View</div>
            <div id="blur-wrapper" class="blurred">
                <h3 id="style-name-preview">Style Name</h3>
                <div id="manifesto-content">
                    </div>
            </div>
        </div>
    </div>

    <div id="success-view" class="section">
        <h1 style="color: #28a745; text-align:center;">Access Granted! ✔️</h1>
        <div class="result-display-box">
            <div id="final-result-content">
                </div>
        </div>
        <button class="btn btn-start" onclick="window.location.href='/'">Take Test Again</button>
    </div>
</div>

<div id="footerBar" class="float-bar">
    <span style="display:block; margin-bottom:10px; font-weight:bold;">Unlock your full romantic roadmap:</span>
    <button class="btn btn-wish" onclick="pay(true)">Unlock Full Results ($3)</button>
    <button class="btn btn-no" onclick="pay(false)">No thanks</button>
</div>

<div id="data-store" style="display:none;">
    <div id="raw-bold">
        <h3>BOLD – DIRECT FLIRT</h3>
        <p>You connect through energy and confidence. You don’t wait—you take initiative.</p>
        <p><strong>Strengths:</strong> Charisma, courage, presence.</p>
        <p><strong>⚠️ Tip:</strong> Pace yourself to let chemistry build naturally.</p>
    </div>
    <div id="raw-calm">
        <h3>CALM – COMFORT CREATOR</h3>
        <p>You make people feel safe and seen. Your presence is grounding and effortless.</p>
        <p><strong>Strengths:</strong> Empathy, patience, EQ.</p>
        <p><strong>⚠️ Tip:</strong> Show romantic intent clearly to avoid the "friend zone".</p>
    </div>
    <div id="raw-versatile">
        <h3>VERSATILE – VIBE ADAPTER</h3>
        <p>You read the room fast and adapt. You are unpredictable and naturally engaging.</p>
        <p><strong>Strengths:</strong> Intuition, social intelligence, flexibility.</p>
        <p><strong>⚠️ Tip:</strong> Stay grounded so you don't seem hard to read.</p>
    </div>
    <div id="raw-elegant">
        <h3>ELEGANT – TIMING & PRECISION</h3>
        <p>Every word has purpose. Your flirting is subtle, clean, and highly confident.</p>
        <p><strong>Strengths:</strong> Discipline, maturity, composure.</p>
        <p><strong>⚠️ Tip:</strong> Allow spontaneity to appear more approachable.</p>
    </div>
</div>

<script>
const questions = [
  { q: "What feels most natural when you talk to the person you like?", a: ["I jump in directly", "I stay calm and listen", "I mix styles", "I stay controlled"] },
  { q: "What is your biggest strength?", a: ["Confidence", "Empathy", "Adaptability", "Self-control"] },
  { q: "How do you like to gain interest?", a: ["Teasing", "Closeness", "Social cues", "Classy dialogue"] },
  // ... restul intrebarilor se adauga aici in acelasi format
];

const scoreKeys = ["bold", "calm", "versatile", "elegant"];
let current = 0;
let scores = { bold: 0, calm: 0, versatile: 0, elegant: 0 };

function navigate(id) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
}

function startQuiz() {
    current = 0;
    scores = { bold: 0, calm: 0, versatile: 0, elegant: 0 };
    navigate('quiz');
    loadQ();
}

function loadQ() {
    if (current >= questions.length) {
        finishQuiz();
        return;
    }
    const q = questions[current];
    document.getElementById('q-title').innerText = q.q;
    const container = document.getElementById('q-options');
    container.innerHTML = '';
    
    q.a.forEach((opt, index) => {
        const b = document.createElement('button');
        b.className = 'btn btn-opt';
        b.innerText = opt;
        b.onclick = () => {
            scores[scoreKeys[index]]++; // Leaga butonul de categorie
            current++;
            loadQ();
        };
        container.appendChild(b);
    });
}

function finishQuiz() {
    const choice = Object.keys(scores).reduce((a, b) => scores[a] > scores[b] ? a : b);
    localStorage.setItem("userResult", choice);
    
    // Pregatim preview-ul blurat
    document.getElementById('style-name-preview').innerText = choice.toUpperCase();
    document.getElementById('manifesto-content').innerHTML = document.getElementById('raw-' + choice).innerHTML;
    
    navigate('result-preview');
    document.getElementById('footerBar').style.display = 'block';
}

function pay(sub) {
    const choice = localStorage.getItem("userResult");
    // Trimitem catre serverul tau Railway care gestioneaza Stripe
    window.location.href = `/pay-session?subscribe=${sub}&choice=${choice}`;
}

// Cand userul se intoarce de la plata:
window.onload = () => {
    const params = new URLSearchParams(window.location.search);
    if (params.has('session_id')) {
        const choice = localStorage.getItem("userResult") || "bold";
        navigate('success-view');
        document.getElementById('footerBar').style.display = 'none';
        // Afisam rezultatul fara blur
        document.getElementById('final-result-content').innerHTML = document.getElementById('raw-' + choice).innerHTML;
    }
};
</script>
</body>
</html>
